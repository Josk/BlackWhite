<html>
	<head>
		<title></title>
		<link type="text/css" rel="stylesheet" href="css/style.css">

	</head>
	<body>
		<canvas id="box2d-demo" width="800" height="600"></canvas>
		<script src="libs/Box2dWeb-2.1.a.3.js"></script>
		<script src="libs/inputControl.js"></script>
		<script>
			var b2World = Box2D.Dynamics.b2World;
			var b2Vec2 = Box2D.Common.Math.b2Vec2;
			var b2FixtureDef = Box2D.Dynamics.b2FixtureDef;
			var b2BodyDef = Box2D.Dynamics.b2BodyDef;
			var b2CircleShape = Box2D.Collision.Shapes.b2CircleShape;
			var b2Body = Box2D.Dynamics.b2Body;
			var b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape;
		</script>
		<script src="scripts/World.js"></script>
		<script src="scripts/Tank.js"></script>
		<script src="scripts/Copter.js"></script>
		<script>
			var canvas = document.getElementById("box2d-demo");
			var ctx = canvas.getContext('2d');
			
			window.onload = function(){
				window.requestAnimFrame = (function(){
				      return  window.requestAnimationFrame       || 
				              window.webkitRequestAnimationFrame || 
				              window.mozRequestAnimationFrame    || 
				              window.oRequestAnimationFrame      || 
				              window.msRequestAnimationFrame     || 
				              function(/* function */ callback, /* DOMElement */ element){
				                window.setTimeout(callback, 1000 / 60);
				              };
				})();

				var copter;
				var SCALE;
				var world;
				var keys;
				var tank
				
				function init(){
					
					keys = new Keys();
					var tab = {};
					tab["left"] = [37];
					tab["right"] = [39];
					tab["up"] = [38];
					tab["down"] = [40];
					keys.init(tab,window);
					world = new World();
					var debugDraw = new Box2D.Dynamics.b2DebugDraw;
					debugDraw.SetSprite(ctx);
					debugDraw.SetDrawScale(1);
					debugDraw.SetFillAlpha(0.3);
					debugDraw.SetLineThickness(1.0);
					debugDraw.SetFlags(Box2D.Dynamics.b2DebugDraw.e_shapeBit | Box2D.Dynamics.b2DebugDraw.e_joinBit);
					world.world.SetDebugDraw(debugDraw);
					tank = new Tank();
					tank.init(world.world);
					copter = new Copter();
					copter.init(world.world);

				}
				init();
				run();
				function run(){
					world.world.Step(1/60,8,3);
					world.world.DrawDebugData();
					world.world.ClearForces();
					copter.Move(keys,b2Vec2);
					tank.Move(b2Vec2);
					tank.checkBorders(b2Vec2);
					requestAnimFrame(run);
					/*Time.currentTime = Date.now();
                   
					if ( Time.currentTime - Time.lastRender < 16 ) // 60 FPS max
					{
					       return;
					}
					Time.lastRender = Time.currentTime;
					Time.update( Time.currentTime );*/
				}
			}
		</script>
	</body>
</html>

